<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Projection Model - P1 Course</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: #f8f9fa; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 30px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header h1 { color: #2c3e50; margin: 0; }
        .header p { color: #7f8c8d; margin: 5px 0; }
        .tabs { display: flex; background: white; border-radius: 10px; margin-bottom: 20px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; border: none; background: #ecf0f1; color: #2c3e50; font-weight: 600; transition: all 0.3s; }
        .tab.active { background: #3498db; color: white; }
        .tab:hover:not(.active) { background: #d5dbdb; }
        .tab-content { display: none; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .tab-content.active { display: block; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 25px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }
        .form-group input:focus { border-color: #3498db; outline: none; box-shadow: 0 0 5px rgba(52, 152, 219, 0.3); }
        .projection-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 12px; }
        .projection-table th, .projection-table td { padding: 8px; text-align: right; border: 1px solid #ddd; }
        .projection-table th { background: #3498db; color: white; font-weight: 600; }
        .projection-table tbody tr:nth-child(even) { background: #f8f9fa; }
        .projection-table tbody tr:hover { background: #e8f4f8; }
        .currency { text-align: right; }
        .positive { color: #27ae60; font-weight: bold; }
        .negative { color: #e74c3c; font-weight: bold; }
        .chart-container { margin: 25px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; }
        .chart-placeholder { height: 300px; background: white; border-radius: 5px; display: flex; align-items: center; justify-content: center; color: #7f8c8d; border: 2px dashed #bdc3c7; }
        .summary-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .summary-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; }
        .summary-card h4 { margin: 0 0 10px 0; font-size: 14px; opacity: 0.9; }
        .summary-card .value { font-size: 24px; font-weight: bold; margin: 5px 0; }
        .summary-card .change { font-size: 12px; opacity: 0.8; }
        .export-controls { margin: 20px 0; text-align: center; }
        .export-btn { background: #3498db; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 0 10px; font-weight: 600; }
        .export-btn:hover { background: #2980b9; }
        .scenario-slider { margin: 15px 0; }
        .scenario-slider label { display: block; margin-bottom: 5px; font-weight: 600; }
        .scenario-slider input[type="range"] { width: 100%; margin: 10px 0; }
        .scenario-value { text-align: center; font-weight: bold; color: #3498db; }
        @media (max-width: 768px) {
            .tabs { flex-direction: column; }
            .form-grid { grid-template-columns: 1fr; }
            .projection-table { font-size: 10px; }
            .projection-table th, .projection-table td { padding: 4px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Financial Projection Model</h1>
            <p>The Indian Startup - P1 Course Template</p>
            <p style="color: #3498db; font-weight: bold;">3-Year Financial Forecasting for Indian Startups</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('assumptions')">üìù Assumptions</button>
            <button class="tab" onclick="showTab('projections')">üìà Projections</button>
            <button class="tab" onclick="showTab('scenarios')">üéØ Scenarios</button>
            <button class="tab" onclick="showTab('analysis')">üßÆ Analysis</button>
        </div>

        <div id="assumptions" class="tab-content active">
            <h3>üí° Business Assumptions</h3>
            
            <div class="form-grid">
                <div class="form-group">
                    <label>Company Name</label>
                    <input type="text" id="companyName" placeholder="Your Startup Name" value="Your Startup">
                </div>
                <div class="form-group">
                    <label>Business Model</label>
                    <select id="businessModel">
                        <option value="saas">SaaS/Subscription</option>
                        <option value="marketplace">Marketplace</option>
                        <option value="ecommerce">E-commerce</option>
                        <option value="fintech">Fintech</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Launch Date</label>
                    <input type="month" id="launchDate" value="2024-01">
                </div>
                <div class="form-group">
                    <label>Currency</label>
                    <select id="currency">
                        <option value="INR">Indian Rupee (‚Çπ)</option>
                        <option value="USD">US Dollar ($)</option>
                    </select>
                </div>
            </div>

            <h4>üìà Revenue Assumptions</h4>
            <div class="form-grid">
                <div class="form-group">
                    <label>Average Revenue Per User (ARPU) - Monthly (‚Çπ)</label>
                    <input type="number" id="arpu" value="999" min="0">
                </div>
                <div class="form-group">
                    <label>Initial Customers (Month 1)</label>
                    <input type="number" id="initialCustomers" value="10" min="0">
                </div>
                <div class="form-group">
                    <label>Monthly Customer Growth Rate (%)</label>
                    <input type="number" id="customerGrowthRate" value="20" min="0" max="100" step="0.1">
                </div>
                <div class="form-group">
                    <label>Monthly Churn Rate (%)</label>
                    <input type="number" id="churnRate" value="5" min="0" max="50" step="0.1">
                </div>
                <div class="form-group">
                    <label>Annual Price Increase (%)</label>
                    <input type="number" id="priceIncrease" value="10" min="0" max="50" step="0.1">
                </div>
                <div class="form-group">
                    <label>Additional Revenue Streams (Monthly ‚Çπ)</label>
                    <input type="number" id="additionalRevenue" value="0" min="0">
                </div>
            </div>

            <h4>üí∏ Cost Assumptions</h4>
            <div class="form-grid">
                <div class="form-group">
                    <label>Cost of Goods Sold (% of Revenue)</label>
                    <input type="number" id="cogs" value="20" min="0" max="100" step="0.1">
                </div>
                <div class="form-group">
                    <label>Initial Team Size</label>
                    <input type="number" id="initialTeamSize" value="3" min="1">
                </div>
                <div class="form-group">
                    <label>Average Salary per Employee (‚Çπ/month)</label>
                    <input type="number" id="avgSalary" value="50000" min="0">
                </div>
                <div class="form-group">
                    <label>Team Growth Rate (% per quarter)</label>
                    <input type="number" id="teamGrowthRate" value="25" min="0" step="0.1">
                </div>
                <div class="form-group">
                    <label>Marketing Spend (% of Revenue)</label>
                    <input type="number" id="marketingSpend" value="30" min="0" max="100" step="0.1">
                </div>
                <div class="form-group">
                    <label>Technology & Infrastructure (‚Çπ/month)</label>
                    <input type="number" id="techCosts" value="25000" min="0">
                </div>
                <div class="form-group">
                    <label>Office & Operations (‚Çπ/month)</label>
                    <input type="number" id="operationalCosts" value="30000" min="0">
                </div>
                <div class="form-group">
                    <label>Other Fixed Costs (‚Çπ/month)</label>
                    <input type="number" id="otherCosts" value="15000" min="0">
                </div>
            </div>

            <button class="export-btn" onclick="calculateProjections()">üöÄ Generate Projections</button>
        </div>

        <div id="projections" class="tab-content">
            <h3>üìä 3-Year Financial Projections</h3>
            
            <div class="summary-cards" id="summaryCards">
                <!-- Summary cards will be populated by JavaScript -->
            </div>

            <div class="chart-container">
                <div class="chart-placeholder">
                    üìà Revenue & Profit Chart
                    <br><small>Interactive chart would be displayed here in full implementation</small>
                </div>
            </div>

            <table class="projection-table" id="projectionTable">
                <!-- Table will be populated by JavaScript -->
            </table>
        </div>

        <div id="scenarios" class="tab-content">
            <h3>üéØ Scenario Analysis</h3>
            <p>Adjust key variables to see how they impact your financial projections</p>

            <div class="form-grid">
                <div class="scenario-slider">
                    <label>Customer Growth Rate Multiplier</label>
                    <input type="range" id="growthMultiplier" min="0.5" max="2" step="0.1" value="1">
                    <div class="scenario-value" id="growthValue">1.0x</div>
                </div>
                <div class="scenario-slider">
                    <label>ARPU Multiplier</label>
                    <input type="range" id="arpuMultiplier" min="0.5" max="2" step="0.1" value="1">
                    <div class="scenario-value" id="arpuValue">1.0x</div>
                </div>
                <div class="scenario-slider">
                    <label>Cost Efficiency (Lower = Better)</label>
                    <input type="range" id="costMultiplier" min="0.5" max="1.5" step="0.1" value="1">
                    <div class="scenario-value" id="costValue">1.0x</div>
                </div>
                <div class="scenario-slider">
                    <label>Market Penetration Speed</label>
                    <input type="range" id="marketMultiplier" min="0.5" max="2" step="0.1" value="1">
                    <div class="scenario-value" id="marketValue">1.0x</div>
                </div>
            </div>

            <button class="export-btn" onclick="runScenarioAnalysis()">üîç Run Scenario Analysis</button>

            <div id="scenarioResults">
                <!-- Scenario results will be populated here -->
            </div>
        </div>

        <div id="analysis" class="tab-content">
            <h3>üßÆ Financial Analysis & Insights</h3>
            
            <div id="analysisContent">
                <div style="text-align: center; color: #7f8c8d; margin: 50px 0;">
                    Run projections to see detailed financial analysis and insights
                </div>
            </div>
        </div>

        <div class="export-controls">
            <button class="export-btn" onclick="exportToExcel()">üìä Export to Excel</button>
            <button class="export-btn" onclick="exportToPDF()">üìÑ Export to PDF</button>
            <button class="export-btn" onclick="saveModel()">üíæ Save Model</button>
            <button class="export-btn" onclick="loadModel()">üìÇ Load Model</button>
        </div>
    </div>

    <script>
        let projectionData = [];
        let currentScenario = {};

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function formatCurrency(amount) {
            const currency = document.getElementById('currency').value;
            const symbol = currency === 'INR' ? '‚Çπ' : '$';
            return symbol + Math.round(amount).toLocaleString('en-IN');
        }

        function calculateProjections() {
            const assumptions = getAssumptions();
            projectionData = [];
            
            let customers = assumptions.initialCustomers;
            let arpu = assumptions.arpu;
            let teamSize = assumptions.initialTeamSize;
            
            for (let month = 1; month <= 36; month++) {
                // Customer growth with churn
                const newCustomers = customers * (assumptions.customerGrowthRate / 100);
                const churnedCustomers = customers * (assumptions.churnRate / 100);
                customers = customers + newCustomers - churnedCustomers;
                
                // Annual ARPU increase
                if (month % 12 === 1 && month > 1) {
                    arpu = arpu * (1 + assumptions.priceIncrease / 100);
                }
                
                // Team growth (quarterly)
                if (month % 3 === 1 && month > 1) {
                    teamSize = teamSize * (1 + assumptions.teamGrowthRate / 100);
                }
                
                // Revenue calculation
                const monthlyRevenue = (customers * arpu) + assumptions.additionalRevenue;
                
                // Cost calculations
                const cogs = monthlyRevenue * (assumptions.cogs / 100);
                const salaryExpense = teamSize * assumptions.avgSalary;
                const marketingExpense = monthlyRevenue * (assumptions.marketingSpend / 100);
                const techExpense = assumptions.techCosts;
                const operationalExpense = assumptions.operationalCosts;
                const otherExpense = assumptions.otherCosts;
                
                const totalExpenses = cogs + salaryExpense + marketingExpense + techExpense + operationalExpense + otherExpense;
                const grossProfit = monthlyRevenue - cogs;
                const netProfit = monthlyRevenue - totalExpenses;
                
                projectionData.push({
                    month,
                    year: Math.ceil(month / 12),
                    quarter: Math.ceil((month % 12 || 12) / 3),
                    customers: Math.round(customers),
                    arpu: Math.round(arpu),
                    revenue: monthlyRevenue,
                    cogs,
                    grossProfit,
                    salaryExpense,
                    marketingExpense,
                    techExpense,
                    operationalExpense,
                    otherExpense,
                    totalExpenses,
                    netProfit,
                    teamSize: Math.round(teamSize)
                });
            }
            
            displayProjections();
            displaySummaryCards();
            showTab('projections');
        }

        function getAssumptions() {
            return {
                companyName: document.getElementById('companyName').value,
                businessModel: document.getElementById('businessModel').value,
                arpu: parseFloat(document.getElementById('arpu').value) || 0,
                initialCustomers: parseFloat(document.getElementById('initialCustomers').value) || 0,
                customerGrowthRate: parseFloat(document.getElementById('customerGrowthRate').value) || 0,
                churnRate: parseFloat(document.getElementById('churnRate').value) || 0,
                priceIncrease: parseFloat(document.getElementById('priceIncrease').value) || 0,
                additionalRevenue: parseFloat(document.getElementById('additionalRevenue').value) || 0,
                cogs: parseFloat(document.getElementById('cogs').value) || 0,
                initialTeamSize: parseFloat(document.getElementById('initialTeamSize').value) || 0,
                avgSalary: parseFloat(document.getElementById('avgSalary').value) || 0,
                teamGrowthRate: parseFloat(document.getElementById('teamGrowthRate').value) || 0,
                marketingSpend: parseFloat(document.getElementById('marketingSpend').value) || 0,
                techCosts: parseFloat(document.getElementById('techCosts').value) || 0,
                operationalCosts: parseFloat(document.getElementById('operationalCosts').value) || 0,
                otherCosts: parseFloat(document.getElementById('otherCosts').value) || 0
            };
        }

        function displaySummaryCards() {
            if (projectionData.length === 0) return;
            
            const year1Data = projectionData.slice(0, 12);
            const year2Data = projectionData.slice(12, 24);
            const year3Data = projectionData.slice(24, 36);
            
            const year1Revenue = year1Data.reduce((sum, month) => sum + month.revenue, 0);
            const year2Revenue = year2Data.reduce((sum, month) => sum + month.revenue, 0);
            const year3Revenue = year3Data.reduce((sum, month) => sum + month.revenue, 0);
            
            const year1Profit = year1Data.reduce((sum, month) => sum + month.netProfit, 0);
            const year2Profit = year2Data.reduce((sum, month) => sum + month.netProfit, 0);
            const year3Profit = year3Data.reduce((sum, month) => sum + month.netProfit, 0);
            
            const finalCustomers = projectionData[35].customers;
            const finalTeamSize = projectionData[35].teamSize;
            
            const summaryHtml = `
                <div class="summary-card">
                    <h4>Year 1 Revenue</h4>
                    <div class="value">${formatCurrency(year1Revenue)}</div>
                    <div class="change">Monthly: ${formatCurrency(year1Revenue / 12)}</div>
                </div>
                <div class="summary-card">
                    <h4>Year 3 Revenue</h4>
                    <div class="value">${formatCurrency(year3Revenue)}</div>
                    <div class="change">Growth: ${(((year3Revenue - year1Revenue) / year1Revenue) * 100).toFixed(0)}%</div>
                </div>
                <div class="summary-card">
                    <h4>Customers (Year 3)</h4>
                    <div class="value">${finalCustomers.toLocaleString()}</div>
                    <div class="change">Team Size: ${finalTeamSize}</div>
                </div>
                <div class="summary-card">
                    <h4>Profitability</h4>
                    <div class="value ${year3Profit > 0 ? 'positive' : 'negative'}">${formatCurrency(year3Profit)}</div>
                    <div class="change">Year 3 Net Profit</div>
                </div>
            `;
            
            document.getElementById('summaryCards').innerHTML = summaryHtml;
        }

        function displayProjections() {
            if (projectionData.length === 0) return;
            
            let tableHtml = `
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Customers</th>
                        <th>ARPU</th>
                        <th>Revenue</th>
                        <th>COGS</th>
                        <th>Gross Profit</th>
                        <th>Salaries</th>
                        <th>Marketing</th>
                        <th>Tech</th>
                        <th>Operations</th>
                        <th>Total Expenses</th>
                        <th>Net Profit</th>
                        <th>Team Size</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            projectionData.forEach((month, index) => {
                if (index % 3 === 0 || index < 12) { // Show quarterly for years 2-3, monthly for year 1
                    tableHtml += `
                        <tr>
                            <td>Month ${month.month}</td>
                            <td>${month.customers.toLocaleString()}</td>
                            <td>${formatCurrency(month.arpu)}</td>
                            <td class="currency">${formatCurrency(month.revenue)}</td>
                            <td class="currency">${formatCurrency(month.cogs)}</td>
                            <td class="currency">${formatCurrency(month.grossProfit)}</td>
                            <td class="currency">${formatCurrency(month.salaryExpense)}</td>
                            <td class="currency">${formatCurrency(month.marketingExpense)}</td>
                            <td class="currency">${formatCurrency(month.techExpense)}</td>
                            <td class="currency">${formatCurrency(month.operationalExpense)}</td>
                            <td class="currency">${formatCurrency(month.totalExpenses)}</td>
                            <td class="currency ${month.netProfit >= 0 ? 'positive' : 'negative'}">${formatCurrency(month.netProfit)}</td>
                            <td>${month.teamSize}</td>
                        </tr>
                    `;
                }
            });
            
            tableHtml += '</tbody>';
            document.getElementById('projectionTable').innerHTML = tableHtml;
        }

        function runScenarioAnalysis() {
            // Get scenario multipliers
            const growthMultiplier = parseFloat(document.getElementById('growthMultiplier').value);
            const arpuMultiplier = parseFloat(document.getElementById('arpuMultiplier').value);
            const costMultiplier = parseFloat(document.getElementById('costMultiplier').value);
            const marketMultiplier = parseFloat(document.getElementById('marketMultiplier').value);
            
            // Store original assumptions
            const originalAssumptions = getAssumptions();
            
            // Apply multipliers temporarily
            document.getElementById('customerGrowthRate').value = originalAssumptions.customerGrowthRate * growthMultiplier;
            document.getElementById('arpu').value = originalAssumptions.arpu * arpuMultiplier;
            document.getElementById('avgSalary').value = originalAssumptions.avgSalary * costMultiplier;
            document.getElementById('marketingSpend').value = originalAssumptions.marketingSpend * marketMultiplier;
            
            // Recalculate projections
            calculateProjections();
            
            // Calculate impact
            const year3Revenue = projectionData.slice(24, 36).reduce((sum, month) => sum + month.revenue, 0);
            const year3Profit = projectionData.slice(24, 36).reduce((sum, month) => sum + month.netProfit, 0);
            
            const scenarioHtml = `
                <div class="summary-cards">
                    <div class="summary-card">
                        <h4>Scenario Year 3 Revenue</h4>
                        <div class="value">${formatCurrency(year3Revenue)}</div>
                    </div>
                    <div class="summary-card">
                        <h4>Scenario Year 3 Profit</h4>
                        <div class="value ${year3Profit >= 0 ? 'positive' : 'negative'}">${formatCurrency(year3Profit)}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('scenarioResults').innerHTML = scenarioHtml;
            
            // Restore original values
            Object.keys(originalAssumptions).forEach(key => {
                const element = document.getElementById(key);
                if (element && originalAssumptions[key] !== undefined) {
                    element.value = originalAssumptions[key];
                }
            });
        }

        function exportToExcel() {
            // In a real implementation, this would generate an Excel file
            alert('Excel export would be available in the full version. For now, you can copy the table data.');
        }

        function exportToPDF() {
            window.print();
        }

        function saveModel() {
            const modelData = {
                assumptions: getAssumptions(),
                projectionData: projectionData,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('financialModel', JSON.stringify(modelData));
            alert('Financial model saved successfully!');
        }

        function loadModel() {
            const savedModel = localStorage.getItem('financialModel');
            if (savedModel) {
                const modelData = JSON.parse(savedModel);
                
                // Load assumptions
                Object.keys(modelData.assumptions).forEach(key => {
                    const element = document.getElementById(key);
                    if (element && modelData.assumptions[key] !== undefined) {
                        element.value = modelData.assumptions[key];
                    }
                });
                
                // Load projection data
                projectionData = modelData.projectionData;
                displayProjections();
                displaySummaryCards();
                
                alert('Financial model loaded successfully!');
            } else {
                alert('No saved model found.');
            }
        }

        // Auto-save inputs
        document.addEventListener('input', function(e) {
            if (e.target.type === 'number' || e.target.type === 'text' || e.target.tagName === 'SELECT') {
                localStorage.setItem('fin_' + e.target.id, e.target.value);
            }
        });

        // Load saved inputs
        window.addEventListener('load', function() {
            document.querySelectorAll('input, select').forEach(function(element) {
                const savedValue = localStorage.getItem('fin_' + element.id);
                if (savedValue && element.id) {
                    element.value = savedValue;
                }
            });
        });

        // Update scenario sliders
        document.addEventListener('input', function(e) {
            if (e.target.type === 'range') {
                const value = parseFloat(e.target.value);
                const valueElement = document.getElementById(e.target.id.replace('Multiplier', 'Value'));
                if (valueElement) {
                    valueElement.textContent = value.toFixed(1) + 'x';
                }
            }
        });

        // Initial load
        document.addEventListener('DOMContentLoaded', function() {
            // Set default date to current month
            const now = new Date();
            const currentMonth = now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0');
            document.getElementById('launchDate').value = currentMonth;
        });
    </script>
</body>
</html>